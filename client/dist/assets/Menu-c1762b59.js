import{_ as ee}from"./_plugin-vue_export-helper-0b6f8918.js";/* empty css                     *//* empty css                   *//* empty css                       *//* empty css                 *//* empty css                        *//* empty css                  *//* empty css                     *//* empty css                      */import{G as _,K as E,c as te,H as le,r as oe,o as b,a as M,b as g,d as t,w as n,L as P,M as O,T as m,J as ae,N as ne,O as se,a0 as re,P as de,Q as ie,R as pe,f as i,a1 as ue,a2 as me,S as ce,U as fe,V as _e,h as ge,W as ve,a4 as be,a3 as ye,Z as Ve,_ as he,$ as we}from"./index-4e5dc47e.js";const ke={class:"menu-management"},Ce={class:"search-form"},Ee={class:"button-group"},Oe={class:"table-container"},Ue={class:"operation-buttons"},xe={class:"pagination"},Ie={class:"dialog-footer"},Te={__name:"Menu",setup(Se){const h=_(!1),U=_([]),c=_(!1),w=_(!1),y=_(),x=_([]),v=E({keyword:""}),r=E({page:1,limit:10,total:0}),l=E({id:null,name:"",path:"",component:"",icon:"",parentId:0,level:1,sortOrder:0,type:1,status:1}),R={name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],path:[{required:!0,message:"请输入菜单路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件名称",trigger:"blur"}]},N=te(()=>l.id?"编辑菜单":"新增菜单"),f=async()=>{h.value=!0;try{const o={page:r.page,limit:r.limit,keyword:v.keyword},s=await(await fetch(`/api/menus?${new URLSearchParams(o)}`)).json();U.value=s.data,r.total=s.total}catch(o){console.error("加载数据失败:",o),m.error("加载数据失败")}finally{h.value=!1}},k=()=>{r.page=1,f()},$=()=>{v.keyword="",k()},I=async()=>{try{const e=await(await fetch("/api/menus")).json();x.value=e.data||e}catch(o){console.error("加载菜单选项失败:",o)}},F=()=>{C(),c.value=!0,I()},L=o=>{C(),Object.assign(l,{id:o.id,name:o.name,path:o.path,component:o.component,icon:o.icon,parentId:o.parent_id,level:o.level,sortOrder:o.sort_order,type:o.type,status:o.status}),c.value=!0,I()},q=async o=>{try{await ce.confirm(`确定要删除菜单 "${o.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await fetch(`/api/menus/${o.id}`,{method:"DELETE"});if(e.ok)m.success("删除成功"),f();else{const s=await e.json();m.error(s.message||"删除失败")}}catch(e){e!=="cancel"&&(console.error("删除失败:",e),m.error("删除失败"))}},J=async()=>{if(y.value)try{await y.value.validate(),w.value=!0;const o={name:l.name,path:l.path,component:l.component,icon:l.icon,parentId:l.parentId,level:l.level,sortOrder:l.sortOrder,type:l.type,status:l.status};let e;if(l.id?e=await fetch(`/api/menus/${l.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}):e=await fetch("/api/menus",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),e.ok)m.success(l.id?"更新成功":"创建成功"),c.value=!1,f();else{const s=await e.json();m.error(s.message||"操作失败")}}catch(o){console.error("提交失败:",o),m.error("操作失败")}finally{w.value=!1}},T=()=>{c.value=!1,C()},C=()=>{var o;(o=y.value)==null||o.resetFields(),Object.assign(l,{id:null,name:"",path:"",component:"",icon:"",parentId:0,level:1,sortOrder:0,type:1,status:1})},K=o=>{r.limit=o,f()},G=o=>{r.page=o,f()};return le(()=>{f()}),(o,e)=>{const s=fe,d=_e,p=ae,S=ne,A=oe("Plus"),H=ge,u=ve,Q=se,W=re,j=be,Z=ye,z=Ve,V=he,D=we,X=de,B=ie;return b(),M("div",ke,[g("div",Ce,[t(S,{model:v,inline:""},{default:n(()=>[t(d,{label:"关键词"},{default:n(()=>[t(s,{modelValue:v.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>v.keyword=a),placeholder:"请输入菜单名称或路径",clearable:"",onKeyup:pe(k,["enter"])},null,8,["modelValue"])]),_:1}),t(d,null,{default:n(()=>[t(p,{type:"primary",onClick:k},{default:n(()=>[...e[13]||(e[13]=[i("搜索",-1)])]),_:1}),t(p,{onClick:$},{default:n(()=>[...e[14]||(e[14]=[i("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),g("div",Ee,[t(p,{type:"primary",onClick:F},{default:n(()=>[t(H,null,{default:n(()=>[t(A)]),_:1}),e[15]||(e[15]=i(" 新增菜单 ",-1))]),_:1})]),g("div",Oe,[P((b(),O(Q,{data:U.value,border:"",style:{width:"100%"}},{default:n(()=>[t(u,{prop:"id",label:"ID",width:"80"}),t(u,{prop:"name",label:"菜单名称",width:"120"}),t(u,{prop:"path",label:"路径",width:"200"}),t(u,{prop:"icon",label:"图标",width:"100"}),t(u,{prop:"level",label:"级别",width:"80"}),t(u,{prop:"sort_order",label:"排序",width:"80"}),t(u,{label:"操作",width:"200",fixed:"right"},{default:n(({row:a})=>[g("div",Ue,[t(p,{size:"small",onClick:Y=>L(a)},{default:n(()=>[...e[16]||(e[16]=[i("编辑",-1)])]),_:1},8,["onClick"]),t(p,{size:"small",type:"danger",onClick:Y=>q(a)},{default:n(()=>[...e[17]||(e[17]=[i(" 删除 ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[B,h.value]]),g("div",xe,[t(W,{"current-page":r.page,"onUpdate:currentPage":e[1]||(e[1]=a=>r.page=a),"page-size":r.limit,"onUpdate:pageSize":e[2]||(e[2]=a=>r.limit=a),"page-sizes":[10,20,50,100],total:r.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:K,onCurrentChange:G},null,8,["current-page","page-size","total"])])]),t(X,{modelValue:c.value,"onUpdate:modelValue":e[12]||(e[12]=a=>c.value=a),title:N.value,width:"600px",onClose:T},{footer:n(()=>[g("span",Ie,[t(p,{onClick:T},{default:n(()=>[...e[22]||(e[22]=[i("取消",-1)])]),_:1}),t(p,{type:"primary",onClick:J},{default:n(()=>[...e[23]||(e[23]=[i("确定",-1)])]),_:1})])]),default:n(()=>[P((b(),O(S,{ref_key:"formRef",ref:y,model:l,rules:R,"label-width":"100px"},{default:n(()=>[t(d,{label:"菜单名称",prop:"name"},{default:n(()=>[t(s,{modelValue:l.name,"onUpdate:modelValue":e[3]||(e[3]=a=>l.name=a),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),t(d,{label:"菜单路径",prop:"path"},{default:n(()=>[t(s,{modelValue:l.path,"onUpdate:modelValue":e[4]||(e[4]=a=>l.path=a),placeholder:"请输入菜单路径"},null,8,["modelValue"])]),_:1}),t(d,{label:"组件名称",prop:"component"},{default:n(()=>[t(s,{modelValue:l.component,"onUpdate:modelValue":e[5]||(e[5]=a=>l.component=a),placeholder:"请输入组件名称"},null,8,["modelValue"])]),_:1}),t(d,{label:"图标",prop:"icon"},{default:n(()=>[t(s,{modelValue:l.icon,"onUpdate:modelValue":e[6]||(e[6]=a=>l.icon=a),placeholder:"请输入图标名称"},null,8,["modelValue"])]),_:1}),t(d,{label:"父级菜单",prop:"parentId"},{default:n(()=>[t(Z,{modelValue:l.parentId,"onUpdate:modelValue":e[7]||(e[7]=a=>l.parentId=a),placeholder:"请选择父级菜单",style:{width:"100%"}},{default:n(()=>[t(j,{label:"无（顶级菜单）",value:0}),(b(!0),M(ue,null,me(x.value,a=>(b(),O(j,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"层级",prop:"level"},{default:n(()=>[t(z,{modelValue:l.level,"onUpdate:modelValue":e[8]||(e[8]=a=>l.level=a),min:1,max:10},null,8,["modelValue"])]),_:1}),t(d,{label:"排序",prop:"sortOrder"},{default:n(()=>[t(z,{modelValue:l.sortOrder,"onUpdate:modelValue":e[9]||(e[9]=a=>l.sortOrder=a),min:0},null,8,["modelValue"])]),_:1}),t(d,{label:"菜单类型",prop:"type"},{default:n(()=>[t(D,{modelValue:l.type,"onUpdate:modelValue":e[10]||(e[10]=a=>l.type=a)},{default:n(()=>[t(V,{label:1},{default:n(()=>[...e[18]||(e[18]=[i("菜单",-1)])]),_:1}),t(V,{label:2},{default:n(()=>[...e[19]||(e[19]=[i("按钮",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"状态",prop:"status"},{default:n(()=>[t(D,{modelValue:l.status,"onUpdate:modelValue":e[11]||(e[11]=a=>l.status=a)},{default:n(()=>[t(V,{label:1},{default:n(()=>[...e[20]||(e[20]=[i("启用",-1)])]),_:1}),t(V,{label:0},{default:n(()=>[...e[21]||(e[21]=[i("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[B,w.value]])]),_:1},8,["modelValue","title"])])}}},Le=ee(Te,[["__scopeId","data-v-9a09c0d9"]]);export{Le as default};
