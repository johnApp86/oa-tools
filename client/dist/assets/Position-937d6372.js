import{_ as ee}from"./_plugin-vue_export-helper-0b6f8918.js";/* empty css                     *//* empty css                   *//* empty css                       *//* empty css                 *//* empty css                        *//* empty css                      *//* empty css                  *//* empty css                     */import{G as c,K as k,c as le,H as te,r as ae,o as g,a as C,b as f,d as l,w as a,L as oe,M as I,J as ne,N as se,O as ie,a0 as re,P as de,Q as ue,R as pe,a1 as B,a2 as D,f as i,I as me,S as _e,T as ce,U as ge,V as fe,a3 as ve,h as be,W as ye,X as Ve,Z as ze,_ as we,$ as ke,a4 as Ce}from"./index-4e5dc47e.js";import{g as Ie,d as Ee,u as xe,c as Oe}from"./position-98fae9c7.js";import{a as Pe}from"./organization-22ca4e80.js";import"./request-3883ec4c.js";const Ue={class:"position-management"},he={class:"search-form"},Be={class:"button-group"},De={class:"table-container"},Se={class:"operation-buttons"},Te={class:"pagination"},Re={__name:"Position",setup(Fe){const b=c(!1),E=c([]),y=c([]),m=c(!1),V=c(!1),v=c(),r=k({keyword:"",organizationId:null}),s=k({page:1,limit:10,total:0}),n=k({id:null,name:"",code:"",organizationId:null,level:1,sortOrder:0,status:1}),S={name:[{required:!0,message:"请输入岗位名称",trigger:"blur"}],code:[{required:!0,message:"请输入岗位代码",trigger:"blur"}],organizationId:[{required:!0,message:"请选择组织",trigger:"change"}]},T=le(()=>n.id?"编辑岗位":"新增岗位"),_=async()=>{b.value=!0;try{const o={page:s.page,limit:s.limit,keyword:r.keyword,organizationId:r.organizationId},e=await Ie(o);E.value=e.data,s.total=e.total}catch(o){console.error("加载数据失败:",o)}finally{b.value=!1}},R=async()=>{try{const o=await Pe();y.value=o}catch(o){console.error("加载组织数据失败:",o)}},z=()=>{s.page=1,_()},F=()=>{r.keyword="",r.organizationId=null,z()},L=()=>{Object.assign(n,{id:null,name:"",code:"",organizationId:null,level:1,sortOrder:0,status:1}),m.value=!0},N=o=>{Object.assign(n,{id:o.id,name:o.name,code:o.code,organizationId:o.organization_id,level:o.level,sortOrder:o.sort_order,status:o.status}),m.value=!0},M=async o=>{try{await _e.confirm("确定要删除该岗位吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Ee(o.id),ce.success("删除成功"),_()}catch(e){e!=="cancel"&&console.error("删除失败:",e)}},$=async()=>{if(v.value)try{await v.value.validate(),V.value=!0,n.id?await xe(n.id,n):await Oe(n),m.value=!1,_()}catch(o){console.error("提交失败:",o)}finally{V.value=!1}},j=()=>{var o;(o=v.value)==null||o.resetFields()},q=o=>{s.limit=o,_()},K=o=>{s.page=o,_()};return te(()=>{_(),R()}),(o,e)=>{const w=ge,d=fe,x=Ce,O=ve,p=ne,P=se,A=ae("Plus"),G=be,u=ye,H=Ve,J=ie,Q=re,U=ze,h=we,W=ke,X=de,Z=ue;return g(),C("div",Ue,[f("div",he,[l(P,{model:r,inline:""},{default:a(()=>[l(d,{label:"关键词"},{default:a(()=>[l(w,{modelValue:r.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>r.keyword=t),placeholder:"请输入岗位名称或代码",clearable:"",onKeyup:pe(z,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"组织"},{default:a(()=>[l(O,{modelValue:r.organizationId,"onUpdate:modelValue":e[1]||(e[1]=t=>r.organizationId=t),placeholder:"请选择组织",clearable:""},{default:a(()=>[(g(!0),C(B,null,D(y.value,t=>(g(),I(x,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:a(()=>[l(p,{type:"primary",onClick:z},{default:a(()=>[...e[12]||(e[12]=[i("搜索",-1)])]),_:1}),l(p,{onClick:F},{default:a(()=>[...e[13]||(e[13]=[i("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),f("div",Be,[l(p,{type:"primary",onClick:L},{default:a(()=>[l(G,null,{default:a(()=>[l(A)]),_:1}),e[14]||(e[14]=i(" 新增岗位 ",-1))]),_:1})]),f("div",De,[oe((g(),I(J,{data:E.value,stripe:"",border:""},{default:a(()=>[l(u,{prop:"id",label:"ID",width:"80"}),l(u,{prop:"name",label:"岗位名称",width:"150"}),l(u,{prop:"code",label:"岗位代码",width:"120"}),l(u,{prop:"org_name",label:"所属组织",width:"150"}),l(u,{prop:"level",label:"层级",width:"80"}),l(u,{prop:"sort_order",label:"排序",width:"80"}),l(u,{prop:"status",label:"状态",width:"100"},{default:a(({row:t})=>[l(H,{type:t.status===1?"success":"danger"},{default:a(()=>[i(me(t.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(u,{prop:"created_at",label:"创建时间",width:"180"}),l(u,{label:"操作",width:"200",fixed:"right"},{default:a(({row:t})=>[f("div",Se,[l(p,{size:"small",onClick:Y=>N(t)},{default:a(()=>[...e[15]||(e[15]=[i("编辑",-1)])]),_:1},8,["onClick"]),l(p,{size:"small",type:"danger",onClick:Y=>M(t)},{default:a(()=>[...e[16]||(e[16]=[i(" 删除 ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[Z,b.value]]),f("div",Te,[l(Q,{"current-page":s.page,"onUpdate:currentPage":e[2]||(e[2]=t=>s.page=t),"page-size":s.limit,"onUpdate:pageSize":e[3]||(e[3]=t=>s.limit=t),total:s.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:K},null,8,["current-page","page-size","total"])])]),l(X,{modelValue:m.value,"onUpdate:modelValue":e[11]||(e[11]=t=>m.value=t),title:T.value,width:"600px",onClose:j},{footer:a(()=>[l(p,{onClick:e[10]||(e[10]=t=>m.value=!1)},{default:a(()=>[...e[19]||(e[19]=[i("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:$,loading:V.value},{default:a(()=>[...e[20]||(e[20]=[i(" 确定 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[l(P,{ref_key:"formRef",ref:v,model:n,rules:S,"label-width":"100px"},{default:a(()=>[l(d,{label:"岗位名称",prop:"name"},{default:a(()=>[l(w,{modelValue:n.name,"onUpdate:modelValue":e[4]||(e[4]=t=>n.name=t),placeholder:"请输入岗位名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"岗位代码",prop:"code"},{default:a(()=>[l(w,{modelValue:n.code,"onUpdate:modelValue":e[5]||(e[5]=t=>n.code=t),placeholder:"请输入岗位代码"},null,8,["modelValue"])]),_:1}),l(d,{label:"所属组织",prop:"organizationId"},{default:a(()=>[l(O,{modelValue:n.organizationId,"onUpdate:modelValue":e[6]||(e[6]=t=>n.organizationId=t),placeholder:"请选择组织",style:{width:"100%"}},{default:a(()=>[(g(!0),C(B,null,D(y.value,t=>(g(),I(x,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"层级",prop:"level"},{default:a(()=>[l(U,{modelValue:n.level,"onUpdate:modelValue":e[7]||(e[7]=t=>n.level=t),min:1,max:10},null,8,["modelValue"])]),_:1}),l(d,{label:"排序",prop:"sortOrder"},{default:a(()=>[l(U,{modelValue:n.sortOrder,"onUpdate:modelValue":e[8]||(e[8]=t=>n.sortOrder=t),min:0},null,8,["modelValue"])]),_:1}),l(d,{label:"状态",prop:"status"},{default:a(()=>[l(W,{modelValue:n.status,"onUpdate:modelValue":e[9]||(e[9]=t=>n.status=t)},{default:a(()=>[l(h,{label:1},{default:a(()=>[...e[17]||(e[17]=[i("启用",-1)])]),_:1}),l(h,{label:0},{default:a(()=>[...e[18]||(e[18]=[i("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Xe=ee(Re,[["__scopeId","data-v-632acf37"]]);export{Xe as default};
