import{_ as ie}from"./_plugin-vue_export-helper-0b6f8918.js";/* empty css                     *//* empty css                   *//* empty css                 *//* empty css                        *//* empty css                      *//* empty css                  *//* empty css                     *//* empty css                             */import{G as c,K as w,c as me,H as pe,o as q,a as ce,b as v,d as e,w as o,L as _e,M as fe,T as _,J as ve,N as ge,O as be,a0 as ye,P as Ve,Q as ke,R as we,f as r,g as z,I as C,aj as Ce,S as he,U as De,V as xe,a4 as Ye,a3 as Ee,a8 as Me,h as Re,W as Ue,X as Se,Z as ze,x as Te,F as Fe,al as Be}from"./index-4e5dc47e.js";const Ie={class:"accounts-receivable-management"},Ne={class:"search-form"},Ae={class:"button-group"},qe={class:"table-container"},Le={class:"operation-buttons"},Oe={class:"pagination-container"},Pe={class:"dialog-footer"},$e={class:"dialog-footer"},je={__name:"AccountsReceivable",setup(Ke){const h=c(!1),T=c([]),F=c([]),b=c(!1),y=c(!1),D=c(!1),x=c(!1),k=c(),Y=c(),p=w({page:1,limit:10,total:0}),i=w({keyword:"",status:"",dateRange:[]}),n=w({id:null,invoice_no:"",customer_name:"",amount:0,due_date:"",remark:""}),s=w({amount:0,maxAmount:0,payment_method:"",receive_date:"",remark:""}),L={invoice_no:[{required:!0,message:"请输入发票号",trigger:"blur"}],customer_name:[{required:!0,message:"请输入客户名称",trigger:"blur"}],amount:[{required:!0,message:"请输入应收金额",trigger:"blur"}],due_date:[{required:!0,message:"请选择到期日期",trigger:"change"}]},O={amount:[{required:!0,message:"请输入收款金额",trigger:"blur"}],payment_method:[{required:!0,message:"请选择收款方式",trigger:"change"}],receive_date:[{required:!0,message:"请选择收款日期",trigger:"change"}]},P=me(()=>n.id?"编辑应收账":"新增应收账"),g=async()=>{h.value=!0;try{const l=[{id:1,invoice_no:"INV-2025-001",customer_name:"ABC公司",amount:5e4,received_amount:2e4,balance:3e4,due_date:"2025-11-30",status:"partial",created_at:"2025-10-30 17:00:00"},{id:2,invoice_no:"INV-2025-002",customer_name:"XYZ公司",amount:3e4,received_amount:3e4,balance:0,due_date:"2025-11-15",status:"paid",created_at:"2025-10-30 17:00:00"},{id:3,invoice_no:"INV-2025-003",customer_name:"DEF公司",amount:8e4,received_amount:0,balance:8e4,due_date:"2025-10-15",status:"overdue",created_at:"2025-10-30 17:00:00"}];T.value=l,p.total=l.length}catch(l){console.error("加载数据失败:",l),_.error("加载数据失败")}finally{h.value=!1}},E=()=>{p.page=1,g()},$=()=>{i.keyword="",i.status="",i.dateRange=[],E()},j=()=>{Object.assign(n,{id:null,invoice_no:"",customer_name:"",amount:0,due_date:"",remark:""}),b.value=!0},K=l=>{Object.assign(n,{id:l.id,invoice_no:l.invoice_no,customer_name:l.customer_name,amount:l.amount,due_date:l.due_date,remark:l.remark||""}),b.value=!0},X=l=>{Object.assign(s,{amount:l.balance,maxAmount:l.balance,payment_method:"",receive_date:new Date().toISOString().split("T")[0],remark:""}),y.value=!0},Z=()=>{if(F.value.length===0){_.warning("请选择要收款的记录");return}_.info("批量收款功能开发中...")},G=async l=>{try{await he.confirm(`确定要删除应收账"${l.invoice_no}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),_.success("删除成功"),g()}catch{}},H=()=>{_.info("导出功能开发中...")},J=l=>{F.value=l},Q=async()=>{if(k.value)try{await k.value.validate(),D.value=!0,await new Promise(l=>setTimeout(l,1e3)),_.success(n.id?"更新成功":"创建成功"),b.value=!1,g()}catch(l){console.error("提交失败:",l),_.error("操作失败")}finally{D.value=!1}},W=async()=>{if(Y.value)try{await Y.value.validate(),x.value=!0,await new Promise(l=>setTimeout(l,1e3)),_.success("收款成功"),y.value=!1,g()}catch(l){console.error("收款失败:",l),_.error("收款失败")}finally{x.value=!1}},ee=()=>{var l;(l=k.value)==null||l.resetFields()},ae=l=>{p.limit=l,g()},te=l=>{p.page=l,g()},le=l=>({unpaid:"info",partial:"warning",paid:"success",overdue:"danger"})[l]||"info",oe=l=>({unpaid:"未收款",partial:"部分收款",paid:"已收款",overdue:"逾期"})[l]||l,ne=l=>l>0?"positive-balance":"zero-balance",M=l=>l==null?"0.00":Number(l).toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2});return pe(()=>{g()}),(l,a)=>{const V=De,u=xe,f=Ye,B=Ee,R=Me,d=ve,U=ge,S=Re,m=Ue,re=Se,ue=be,de=ye,I=ze,N=Ve,se=ke;return q(),ce("div",Ie,[v("div",Ne,[e(U,{model:i,inline:""},{default:o(()=>[e(u,{label:"关键词"},{default:o(()=>[e(V,{modelValue:i.keyword,"onUpdate:modelValue":a[0]||(a[0]=t=>i.keyword=t),placeholder:"请输入客户名称或发票号",clearable:"",onKeyup:we(E,["enter"])},null,8,["modelValue"])]),_:1}),e(u,{label:"状态"},{default:o(()=>[e(B,{modelValue:i.status,"onUpdate:modelValue":a[1]||(a[1]=t=>i.status=t),placeholder:"请选择状态",clearable:""},{default:o(()=>[e(f,{label:"未收款",value:"unpaid"}),e(f,{label:"部分收款",value:"partial"}),e(f,{label:"已收款",value:"paid"}),e(f,{label:"逾期",value:"overdue"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"日期范围"},{default:o(()=>[e(R,{modelValue:i.dateRange,"onUpdate:modelValue":a[2]||(a[2]=t=>i.dateRange=t),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(u,null,{default:o(()=>[e(d,{type:"primary",onClick:E},{default:o(()=>[...a[18]||(a[18]=[r("搜索",-1)])]),_:1}),e(d,{onClick:$},{default:o(()=>[...a[19]||(a[19]=[r("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),v("div",Ae,[e(d,{type:"primary",onClick:j},{default:o(()=>[e(S,null,{default:o(()=>[e(z(Te))]),_:1}),a[20]||(a[20]=r(" 新增应收 ",-1))]),_:1}),e(d,{type:"success",onClick:Z},{default:o(()=>[e(S,null,{default:o(()=>[e(z(Fe))]),_:1}),a[21]||(a[21]=r(" 批量收款 ",-1))]),_:1}),e(d,{type:"warning",onClick:H},{default:o(()=>[e(S,null,{default:o(()=>[e(z(Be))]),_:1}),a[22]||(a[22]=r(" 导出数据 ",-1))]),_:1})]),v("div",qe,[_e((q(),fe(ue,{data:T.value,stripe:"",border:"",onSelectionChange:J},{default:o(()=>[e(m,{type:"selection",width:"55"}),e(m,{prop:"invoice_no",label:"发票号",width:"150"}),e(m,{prop:"customer_name",label:"客户名称",width:"200"}),e(m,{prop:"amount",label:"应收金额",width:"120",align:"right"},{default:o(({row:t})=>[r(C(M(t.amount)),1)]),_:1}),e(m,{prop:"received_amount",label:"已收金额",width:"120",align:"right"},{default:o(({row:t})=>[r(C(M(t.received_amount)),1)]),_:1}),e(m,{prop:"balance",label:"余额",width:"120",align:"right"},{default:o(({row:t})=>[v("span",{class:Ce(ne(t.balance))},C(M(t.balance)),3)]),_:1}),e(m,{prop:"due_date",label:"到期日期",width:"120"}),e(m,{prop:"status",label:"状态",width:"100"},{default:o(({row:t})=>[e(re,{type:le(t.status)},{default:o(()=>[r(C(oe(t.status)),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"created_at",label:"创建时间",width:"180"}),e(m,{label:"操作",width:"200",fixed:"right"},{default:o(({row:t})=>[v("div",Le,[e(d,{size:"small",onClick:A=>K(t)},{default:o(()=>[...a[23]||(a[23]=[r("编辑",-1)])]),_:1},8,["onClick"]),e(d,{size:"small",type:"success",onClick:A=>X(t)},{default:o(()=>[...a[24]||(a[24]=[r(" 收款 ",-1)])]),_:1},8,["onClick"]),e(d,{size:"small",type:"danger",onClick:A=>G(t)},{default:o(()=>[...a[25]||(a[25]=[r(" 删除 ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[se,h.value]])]),v("div",Oe,[e(de,{"current-page":p.page,"onUpdate:currentPage":a[3]||(a[3]=t=>p.page=t),"page-size":p.limit,"onUpdate:pageSize":a[4]||(a[4]=t=>p.limit=t),"page-sizes":[10,20,50,100],total:p.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ae,onCurrentChange:te},null,8,["current-page","page-size","total"])]),e(N,{modelValue:b.value,"onUpdate:modelValue":a[11]||(a[11]=t=>b.value=t),title:P.value,width:"600px",onClose:ee},{footer:o(()=>[v("div",Pe,[e(d,{onClick:a[10]||(a[10]=t=>b.value=!1)},{default:o(()=>[...a[26]||(a[26]=[r("取消",-1)])]),_:1}),e(d,{type:"primary",loading:D.value,onClick:Q},{default:o(()=>[...a[27]||(a[27]=[r(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:o(()=>[e(U,{ref_key:"formRef",ref:k,model:n,rules:L,"label-width":"100px"},{default:o(()=>[e(u,{label:"发票号",prop:"invoice_no"},{default:o(()=>[e(V,{modelValue:n.invoice_no,"onUpdate:modelValue":a[5]||(a[5]=t=>n.invoice_no=t),placeholder:"请输入发票号"},null,8,["modelValue"])]),_:1}),e(u,{label:"客户名称",prop:"customer_name"},{default:o(()=>[e(V,{modelValue:n.customer_name,"onUpdate:modelValue":a[6]||(a[6]=t=>n.customer_name=t),placeholder:"请输入客户名称"},null,8,["modelValue"])]),_:1}),e(u,{label:"应收金额",prop:"amount"},{default:o(()=>[e(I,{modelValue:n.amount,"onUpdate:modelValue":a[7]||(a[7]=t=>n.amount=t),precision:2,min:0,placeholder:"请输入应收金额",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(u,{label:"到期日期",prop:"due_date"},{default:o(()=>[e(R,{modelValue:n.due_date,"onUpdate:modelValue":a[8]||(a[8]=t=>n.due_date=t),type:"date",placeholder:"请选择到期日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(u,{label:"备注",prop:"remark"},{default:o(()=>[e(V,{modelValue:n.remark,"onUpdate:modelValue":a[9]||(a[9]=t=>n.remark=t),type:"textarea",rows:3,placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(N,{modelValue:y.value,"onUpdate:modelValue":a[17]||(a[17]=t=>y.value=t),title:"收款",width:"400px"},{footer:o(()=>[v("div",$e,[e(d,{onClick:a[16]||(a[16]=t=>y.value=!1)},{default:o(()=>[...a[28]||(a[28]=[r("取消",-1)])]),_:1}),e(d,{type:"primary",loading:x.value,onClick:W},{default:o(()=>[...a[29]||(a[29]=[r(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:o(()=>[e(U,{ref_key:"receiveFormRef",ref:Y,model:s,rules:O,"label-width":"100px"},{default:o(()=>[e(u,{label:"收款金额",prop:"amount"},{default:o(()=>[e(I,{modelValue:s.amount,"onUpdate:modelValue":a[12]||(a[12]=t=>s.amount=t),precision:2,min:0,max:s.maxAmount,placeholder:"请输入收款金额",style:{width:"100%"}},null,8,["modelValue","max"])]),_:1}),e(u,{label:"收款方式",prop:"payment_method"},{default:o(()=>[e(B,{modelValue:s.payment_method,"onUpdate:modelValue":a[13]||(a[13]=t=>s.payment_method=t),placeholder:"请选择收款方式"},{default:o(()=>[e(f,{label:"现金",value:"cash"}),e(f,{label:"银行转账",value:"bank_transfer"}),e(f,{label:"支票",value:"check"}),e(f,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"收款日期",prop:"receive_date"},{default:o(()=>[e(R,{modelValue:s.receive_date,"onUpdate:modelValue":a[14]||(a[14]=t=>s.receive_date=t),type:"date",placeholder:"请选择收款日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(u,{label:"备注",prop:"remark"},{default:o(()=>[e(V,{modelValue:s.remark,"onUpdate:modelValue":a[15]||(a[15]=t=>s.remark=t),type:"textarea",rows:2,placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},la=ie(je,[["__scopeId","data-v-27cf42ad"]]);export{la as default};
