import{_ as ee}from"./_plugin-vue_export-helper-0b6f8918.js";/* empty css                     *//* empty css                   *//* empty css                       *//* empty css                 *//* empty css                        *//* empty css                      *//* empty css                  *//* empty css                     */import{G as c,K as k,c as oe,H as le,r as te,o as g,a as C,b as f,d as o,w as t,L as ae,M as I,J as ne,N as se,O as ie,a0 as re,P as de,Q as ue,R as pe,a1 as B,a2 as D,f as i,I as me,S as _e,T as ce,U as ge,V as fe,a3 as ve,h as be,W as we,X as ye,Z as Ve,_ as ze,$ as ke,a4 as Ce}from"./index-25be2468.js";import{g as Ie,d as Ee,u as he,c as xe}from"./position-df53863d.js";import{a as Oe}from"./organization-0a1f3a19.js";import"./request-b9763afa.js";const Pe={class:"position-management"},Ue={class:"search-form"},Be={class:"button-group"},De={class:"table-container"},Se={class:"operation-buttons"},Te={class:"pagination"},Re={__name:"Position",setup(Fe){const b=c(!1),E=c([]),w=c([]),m=c(!1),y=c(!1),v=c(),r=k({keyword:"",organizationId:null}),s=k({page:1,limit:10,total:0}),n=k({id:null,name:"",code:"",organizationId:null,level:1,sortOrder:0,status:1}),S={name:[{required:!0,message:"请输入岗位名称",trigger:"blur"}],code:[{required:!0,message:"请输入岗位代码",trigger:"blur"}],organizationId:[{required:!0,message:"请选择组织",trigger:"change"}]},T=oe(()=>n.id?"编辑岗位":"新增岗位"),_=async()=>{b.value=!0;try{const a={page:s.page,limit:s.limit,keyword:r.keyword,organizationId:r.organizationId},e=await Ie(a);E.value=e.data,s.total=e.total}catch(a){console.error("加载数据失败:",a)}finally{b.value=!1}},R=async()=>{try{const a=await Oe();w.value=a}catch(a){console.error("加载组织数据失败:",a)}},V=()=>{s.page=1,_()},F=()=>{r.keyword="",r.organizationId=null,V()},L=()=>{Object.assign(n,{id:null,name:"",code:"",organizationId:null,level:1,sortOrder:0,status:1}),m.value=!0},N=a=>{Object.assign(n,{id:a.id,name:a.name,code:a.code,organizationId:a.organization_id,level:a.level,sortOrder:a.sort_order,status:a.status}),m.value=!0},M=async a=>{try{await _e.confirm("确定要删除该岗位吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Ee(a.id),ce.success("删除成功"),_()}catch(e){e!=="cancel"&&console.error("删除失败:",e)}},$=async()=>{if(v.value)try{await v.value.validate(),y.value=!0,n.id?await he(n.id,n):await xe(n),m.value=!1,_()}catch(a){console.error("提交失败:",a)}finally{y.value=!1}},j=()=>{var a;(a=v.value)==null||a.resetFields()},q=a=>{s.limit=a,_()},K=a=>{s.page=a,_()};return le(()=>{_(),R()}),(a,e)=>{const z=ge,d=fe,h=Ce,x=ve,p=ne,O=se,A=te("Plus"),G=be,u=we,H=ye,J=ie,Q=re,P=Ve,U=ze,W=ke,X=de,Z=ue;return g(),C("div",Pe,[f("div",Ue,[o(O,{model:r,inline:""},{default:t(()=>[o(d,{label:"关键词"},{default:t(()=>[o(z,{modelValue:r.keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>r.keyword=l),placeholder:"请输入岗位名称或代码",clearable:"",onKeyup:pe(V,["enter"])},null,8,["modelValue"])]),_:1}),o(d,{label:"组织"},{default:t(()=>[o(x,{modelValue:r.organizationId,"onUpdate:modelValue":e[1]||(e[1]=l=>r.organizationId=l),placeholder:"请选择组织",clearable:"",style:{width:"200px"},"popper-append-to-body":!1},{default:t(()=>[(g(!0),C(B,null,D(w.value,l=>(g(),I(h,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,null,{default:t(()=>[o(p,{type:"primary",onClick:V},{default:t(()=>[...e[12]||(e[12]=[i("搜索",-1)])]),_:1}),o(p,{onClick:F},{default:t(()=>[...e[13]||(e[13]=[i("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),f("div",Be,[o(p,{type:"primary",onClick:L},{default:t(()=>[o(G,null,{default:t(()=>[o(A)]),_:1}),e[14]||(e[14]=i(" 新增岗位 ",-1))]),_:1})]),f("div",De,[ae((g(),I(J,{data:E.value,stripe:"",border:"","table-layout":"fixed"},{default:t(()=>[o(u,{prop:"id",label:"ID",width:"80","show-overflow-tooltip":""}),o(u,{prop:"name",label:"岗位名称",width:"150","show-overflow-tooltip":""}),o(u,{prop:"code",label:"岗位代码",width:"120","show-overflow-tooltip":""}),o(u,{prop:"org_name",label:"所属组织",width:"150","show-overflow-tooltip":""}),o(u,{prop:"level",label:"层级",width:"80","show-overflow-tooltip":""}),o(u,{prop:"sort_order",label:"排序",width:"80","show-overflow-tooltip":""}),o(u,{prop:"status",label:"状态",width:"100","show-overflow-tooltip":""},{default:t(({row:l})=>[o(H,{type:l.status===1?"success":"danger"},{default:t(()=>[i(me(l.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),o(u,{prop:"created_at",label:"创建时间",width:"180","show-overflow-tooltip":""}),o(u,{label:"操作",width:"280","show-overflow-tooltipfixed":"right"},{default:t(({row:l})=>[f("div",Se,[o(p,{size:"small",onClick:Y=>N(l)},{default:t(()=>[...e[15]||(e[15]=[i("编辑",-1)])]),_:1},8,["onClick"]),o(p,{size:"small",type:"danger",onClick:Y=>M(l)},{default:t(()=>[...e[16]||(e[16]=[i(" 删除 ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[Z,b.value]]),f("div",Te,[o(Q,{"current-page":s.page,"onUpdate:currentPage":e[2]||(e[2]=l=>s.page=l),"page-size":s.limit,"onUpdate:pageSize":e[3]||(e[3]=l=>s.limit=l),total:s.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:K},null,8,["current-page","page-size","total"])])]),o(X,{modelValue:m.value,"onUpdate:modelValue":e[11]||(e[11]=l=>m.value=l),title:T.value,width:"600px",onClose:j},{footer:t(()=>[o(p,{onClick:e[10]||(e[10]=l=>m.value=!1)},{default:t(()=>[...e[19]||(e[19]=[i("取消",-1)])]),_:1}),o(p,{type:"primary",onClick:$,loading:y.value},{default:t(()=>[...e[20]||(e[20]=[i(" 确定 ",-1)])]),_:1},8,["loading"])]),default:t(()=>[o(O,{ref_key:"formRef",ref:v,model:n,rules:S,"label-width":"100px"},{default:t(()=>[o(d,{label:"岗位名称",prop:"name"},{default:t(()=>[o(z,{modelValue:n.name,"onUpdate:modelValue":e[4]||(e[4]=l=>n.name=l),placeholder:"请输入岗位名称"},null,8,["modelValue"])]),_:1}),o(d,{label:"岗位代码",prop:"code"},{default:t(()=>[o(z,{modelValue:n.code,"onUpdate:modelValue":e[5]||(e[5]=l=>n.code=l),placeholder:"请输入岗位代码"},null,8,["modelValue"])]),_:1}),o(d,{label:"所属组织",prop:"organizationId"},{default:t(()=>[o(x,{modelValue:n.organizationId,"onUpdate:modelValue":e[6]||(e[6]=l=>n.organizationId=l),placeholder:"请选择组织",style:{width:"100%"}},{default:t(()=>[(g(!0),C(B,null,D(w.value,l=>(g(),I(h,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"层级",prop:"level"},{default:t(()=>[o(P,{modelValue:n.level,"onUpdate:modelValue":e[7]||(e[7]=l=>n.level=l),min:1,max:10},null,8,["modelValue"])]),_:1}),o(d,{label:"排序",prop:"sortOrder"},{default:t(()=>[o(P,{modelValue:n.sortOrder,"onUpdate:modelValue":e[8]||(e[8]=l=>n.sortOrder=l),min:0},null,8,["modelValue"])]),_:1}),o(d,{label:"状态",prop:"status"},{default:t(()=>[o(W,{modelValue:n.status,"onUpdate:modelValue":e[9]||(e[9]=l=>n.status=l)},{default:t(()=>[o(U,{label:1},{default:t(()=>[...e[17]||(e[17]=[i("启用",-1)])]),_:1}),o(U,{label:0},{default:t(()=>[...e[18]||(e[18]=[i("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Xe=ee(Re,[["__scopeId","data-v-d02a3913"]]);export{Xe as default};
