import{_ as se}from"./_plugin-vue_export-helper-0b6f8918.js";/* empty css                     *//* empty css               *//* empty css                *//* empty css                   *//* empty css                 *//* empty css                        *//* empty css                      *//* empty css                  *//* empty css                     */import{G as C,K as N,c as E,H as ne,o as r,a as g,b as n,d as a,w as t,L as re,M as y,T as U,J as ue,N as de,O as ie,a0 as pe,P as me,aa as ce,Q as _e,a1 as h,a2 as S,f as p,g as ve,I as v,S as be,a3 as fe,V as ge,h as ye,W as Ve,Z as we,U as ke,a9 as Ce,ab as Ee,x as Ue,a4 as he}from"./index-4e5dc47e.js";import{m as Se,n as xe,o as Re}from"./hr-9ba5c14e.js";import{g as Fe}from"./user-ad827ea9.js";import"./request-3883ec4c.js";const ze={class:"salary-management"},Be={class:"search-form"},De={class:"button-group"},Ne={class:"table-container"},Ie={class:"total-salary"},Oe={class:"operation-buttons"},Le={class:"pagination"},Me={class:"statistics-cards"},Te={class:"stat-content"},qe={class:"stat-value"},$e={class:"stat-content"},je={class:"stat-value"},Pe={class:"stat-content"},Ae={class:"stat-value"},Ye={class:"stat-content"},Ge={class:"stat-value"},He={__name:"Salary",setup(Je){const z=C(!1),V=C([]),w=C(!1),B=C(null),D=C([]),i=N({user_id:"",year:"",month:""}),c=N({page:1,limit:10,total:0}),s=N({user_id:"",year:"",month:"",base_salary:0,bonus:0,allowance:0,deduction:0,notes:""}),q={user_id:[{required:!0,message:"请选择员工",trigger:"change"}],year:[{required:!0,message:"请选择年份",trigger:"change"}],month:[{required:!0,message:"请选择月份",trigger:"change"}],base_salary:[{required:!0,message:"请输入基本工资",trigger:"blur"}]},I=C(),O=E(()=>{const o=new Date().getFullYear(),e=[];for(let m=o-5;m<=o+1;m++)e.push(m);return e}),L=E(()=>Array.from({length:12},(o,e)=>e+1)),M=o=>(o.base_salary||0)+(o.bonus||0)+(o.allowance||0)-(o.deduction||0),_=o=>o?Number(o).toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00",$=E(()=>V.value.reduce((o,e)=>o+(e.base_salary||0),0)),j=E(()=>V.value.reduce((o,e)=>o+(e.bonus||0),0)),P=E(()=>V.value.reduce((o,e)=>o+(e.allowance||0),0)),A=E(()=>V.value.reduce((o,e)=>o+M(e),0)),b=async()=>{z.value=!0;try{const o={page:c.page,limit:c.limit,...i},e=await Se(o);V.value=e.data,c.total=e.total}catch{U.error("加载数据失败")}finally{z.value=!1}},Y=()=>{i.user_id="",i.year="",i.month="",c.page=1,b()},G=async()=>{try{await I.value.validate(),await xe(s),U.success("保存成功"),w.value=!1,H(),b()}catch{U.error("保存失败")}},H=()=>{Object.assign(s,{user_id:"",year:"",month:"",base_salary:0,bonus:0,allowance:0,deduction:0,notes:""}),B.value=null},J=o=>{B.value=o,Object.assign(s,o),w.value=!0},K=async o=>{try{await be.confirm("确定要删除这条薪酬记录吗？","提示",{type:"warning"}),await Re(o.id),U.success("删除成功"),b()}catch(e){e!=="cancel"&&U.error(e.message||"删除失败")}},Q=async()=>{try{const o=await Fe();D.value=o.data||o}catch{U.error("加载基础数据失败")}};return ne(()=>{b(),Q()}),(o,e)=>{const m=he,k=fe,u=ge,f=ue,T=de,W=ye,d=Ve,Z=ie,X=pe,x=we,ee=ke,le=me,R=Ce,F=Ee,ae=ce,te=_e;return r(),g("div",ze,[n("div",Be,[a(T,{model:i,inline:""},{default:t(()=>[a(u,{label:"员工"},{default:t(()=>[a(k,{modelValue:i.user_id,"onUpdate:modelValue":e[0]||(e[0]=l=>i.user_id=l),placeholder:"选择员工",clearable:""},{default:t(()=>[(r(!0),g(h,null,S(D.value,l=>(r(),y(m,{key:l.id,label:l.real_name||l.username,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"年份"},{default:t(()=>[a(k,{modelValue:i.year,"onUpdate:modelValue":e[1]||(e[1]=l=>i.year=l),placeholder:"选择年份",clearable:""},{default:t(()=>[(r(!0),g(h,null,S(O.value,l=>(r(),y(m,{key:l,label:l+"年",value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"月份"},{default:t(()=>[a(k,{modelValue:i.month,"onUpdate:modelValue":e[2]||(e[2]=l=>i.month=l),placeholder:"选择月份",clearable:""},{default:t(()=>[(r(!0),g(h,null,S(L.value,l=>(r(),y(m,{key:l,label:l+"月",value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,null,{default:t(()=>[a(f,{type:"primary",onClick:b},{default:t(()=>[...e[16]||(e[16]=[p("搜索",-1)])]),_:1}),a(f,{onClick:Y},{default:t(()=>[...e[17]||(e[17]=[p("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),n("div",De,[a(f,{type:"primary",onClick:e[3]||(e[3]=l=>w.value=!0)},{default:t(()=>[a(W,null,{default:t(()=>[a(ve(Ue))]),_:1}),e[18]||(e[18]=p(" 新增薪酬记录 ",-1))]),_:1})]),n("div",Ne,[re((r(),y(Z,{data:V.value,stripe:"",border:""},{default:t(()=>[a(d,{prop:"user_name",label:"员工姓名"}),a(d,{prop:"position_name",label:"岗位"}),a(d,{prop:"year",label:"年份"}),a(d,{prop:"month",label:"月份"}),a(d,{prop:"base_salary",label:"基本工资",align:"right"},{default:t(({row:l})=>[p(" ¥"+v(_(l.base_salary)),1)]),_:1}),a(d,{prop:"bonus",label:"奖金",align:"right"},{default:t(({row:l})=>[p(" ¥"+v(_(l.bonus)),1)]),_:1}),a(d,{prop:"allowance",label:"津贴",align:"right"},{default:t(({row:l})=>[p(" ¥"+v(_(l.allowance)),1)]),_:1}),a(d,{prop:"deduction",label:"扣除",align:"right"},{default:t(({row:l})=>[p(" ¥"+v(_(l.deduction)),1)]),_:1}),a(d,{label:"实发工资",align:"right"},{default:t(({row:l})=>[n("span",Ie," ¥"+v(_(M(l))),1)]),_:1}),a(d,{prop:"notes",label:"备注"}),a(d,{prop:"created_at",label:"创建时间"}),a(d,{label:"操作",width:"200"},{default:t(({row:l})=>[n("div",Oe,[a(f,{size:"small",onClick:oe=>J(l)},{default:t(()=>[...e[19]||(e[19]=[p("编辑",-1)])]),_:1},8,["onClick"]),a(f,{size:"small",type:"danger",onClick:oe=>K(l)},{default:t(()=>[...e[20]||(e[20]=[p("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[te,z.value]])]),n("div",Le,[a(X,{"current-page":c.page,"onUpdate:currentPage":e[4]||(e[4]=l=>c.page=l),"page-size":c.limit,"onUpdate:pageSize":e[5]||(e[5]=l=>c.limit=l),total:c.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:b,onCurrentChange:b},null,8,["current-page","page-size","total"])]),a(le,{modelValue:w.value,"onUpdate:modelValue":e[15]||(e[15]=l=>w.value=l),title:B.value?"编辑薪酬记录":"新增薪酬记录",width:"600px"},{footer:t(()=>[a(f,{onClick:e[14]||(e[14]=l=>w.value=!1)},{default:t(()=>[...e[21]||(e[21]=[p("取消",-1)])]),_:1}),a(f,{type:"primary",onClick:G},{default:t(()=>[...e[22]||(e[22]=[p("保存",-1)])]),_:1})]),default:t(()=>[a(T,{model:s,rules:q,ref_key:"salaryFormRef",ref:I,"label-width":"100px"},{default:t(()=>[a(u,{label:"员工",prop:"user_id"},{default:t(()=>[a(k,{modelValue:s.user_id,"onUpdate:modelValue":e[6]||(e[6]=l=>s.user_id=l),placeholder:"选择员工",style:{width:"100%"}},{default:t(()=>[(r(!0),g(h,null,S(D.value,l=>(r(),y(m,{key:l.id,label:l.real_name||l.username,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"年份",prop:"year"},{default:t(()=>[a(k,{modelValue:s.year,"onUpdate:modelValue":e[7]||(e[7]=l=>s.year=l),placeholder:"选择年份",style:{width:"100%"}},{default:t(()=>[(r(!0),g(h,null,S(O.value,l=>(r(),y(m,{key:l,label:l+"年",value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"月份",prop:"month"},{default:t(()=>[a(k,{modelValue:s.month,"onUpdate:modelValue":e[8]||(e[8]=l=>s.month=l),placeholder:"选择月份",style:{width:"100%"}},{default:t(()=>[(r(!0),g(h,null,S(L.value,l=>(r(),y(m,{key:l,label:l+"月",value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"基本工资",prop:"base_salary"},{default:t(()=>[a(x,{modelValue:s.base_salary,"onUpdate:modelValue":e[9]||(e[9]=l=>s.base_salary=l),min:0,precision:2,placeholder:"请输入基本工资",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(u,{label:"奖金"},{default:t(()=>[a(x,{modelValue:s.bonus,"onUpdate:modelValue":e[10]||(e[10]=l=>s.bonus=l),min:0,precision:2,placeholder:"请输入奖金",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(u,{label:"津贴"},{default:t(()=>[a(x,{modelValue:s.allowance,"onUpdate:modelValue":e[11]||(e[11]=l=>s.allowance=l),min:0,precision:2,placeholder:"请输入津贴",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(u,{label:"扣除"},{default:t(()=>[a(x,{modelValue:s.deduction,"onUpdate:modelValue":e[12]||(e[12]=l=>s.deduction=l),min:0,precision:2,placeholder:"请输入扣除金额",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(u,{label:"备注"},{default:t(()=>[a(ee,{modelValue:s.notes,"onUpdate:modelValue":e[13]||(e[13]=l=>s.notes=l),type:"textarea",rows:3,placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),n("div",Me,[a(ae,{gutter:20},{default:t(()=>[a(F,{span:6},{default:t(()=>[a(R,{class:"stat-card"},{default:t(()=>[n("div",Te,[n("div",qe,"¥"+v(_($.value)),1),e[23]||(e[23]=n("div",{class:"stat-label"},"基本工资总额",-1))])]),_:1})]),_:1}),a(F,{span:6},{default:t(()=>[a(R,{class:"stat-card"},{default:t(()=>[n("div",$e,[n("div",je,"¥"+v(_(j.value)),1),e[24]||(e[24]=n("div",{class:"stat-label"},"奖金总额",-1))])]),_:1})]),_:1}),a(F,{span:6},{default:t(()=>[a(R,{class:"stat-card"},{default:t(()=>[n("div",Pe,[n("div",Ae,"¥"+v(_(P.value)),1),e[25]||(e[25]=n("div",{class:"stat-label"},"津贴总额",-1))])]),_:1})]),_:1}),a(F,{span:6},{default:t(()=>[a(R,{class:"stat-card"},{default:t(()=>[n("div",Ye,[n("div",Ge,"¥"+v(_(A.value)),1),e[26]||(e[26]=n("div",{class:"stat-label"},"实发工资总额",-1))])]),_:1})]),_:1})]),_:1})])])}}},dl=se(He,[["__scopeId","data-v-637aaa72"]]);export{dl as default};
