import{_ as ne}from"./_plugin-vue_export-helper-0b6f8918.js";/* empty css                     *//* empty css                    *//* empty css                *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                      *//* empty css                 */import{G as m,c as ie,K as O,H as de,o as v,a as C,b as o,d as l,w as t,I as i,L as re,M as B,T as w,J as ue,N as pe,h as _e,O as me,a0 as fe,P as ce,Q as ve,R as G,f as p,g as F,a1 as T,a2 as I,ac as ge,S as ye,U as be,V as Ve,W as ke,a3 as we,ab as Ee,aa as Ce,ad as Fe,a9 as Ue,a7 as ze,a6 as xe,x as Be,q as De,p as Se,ae as Re,n as je,a4 as Pe}from"./index-4e5dc47e.js";import{p as qe,q as Oe,r as Te}from"./hr-9ba5c14e.js";import{g as Ie}from"./user-ad827ea9.js";import{a as Ne}from"./position-98fae9c7.js";import{a as $e}from"./organization-22ca4e80.js";import"./request-3883ec4c.js";const Ke={class:"employee-management"},Le={class:"search-form"},Me={class:"button-group"},he={class:"employee-stats"},Ae={class:"stat-card"},Ge={class:"stat-icon employee"},He={class:"stat-info"},Je={class:"stat-value"},Qe={class:"stat-card"},We={class:"stat-icon department"},Xe={class:"stat-info"},Ye={class:"stat-value"},Ze={class:"stat-card"},el={class:"stat-icon position"},ll={class:"stat-info"},tl={class:"stat-value"},al={class:"stat-card"},ol={class:"stat-icon organization"},sl={class:"stat-info"},nl={class:"stat-value"},il={class:"table-container"},dl={class:"employee-id"},rl={class:"department-tag"},ul={class:"operation-buttons"},pl={class:"pagination"},_l={key:0,class:"file-detail"},ml={class:"detail-item"},fl={class:"value"},cl={class:"detail-item"},vl={class:"value"},gl={class:"detail-item"},yl={class:"value"},bl={class:"detail-item"},Vl={class:"value"},kl={class:"detail-item"},wl={class:"value"},El={class:"json-content"},Cl={class:"json-content"},Fl={class:"json-content"},Ul={class:"json-content"},zl={__name:"Employee",setup(xl){const D=m(!1),b=m([]),V=m(!1),S=m(!1),R=m(null),_=m(null),N=m([]),$=m([]),K=m([]),L=m(null),U=ie(()=>{const s=b.value.length,e=new Set(b.value.map(r=>r.department).filter(Boolean)).size,u=new Set(b.value.map(r=>r.position_name).filter(Boolean)).size,d=new Set(b.value.map(r=>r.org_name).filter(Boolean)).size;return{total:s,departments:e,positions:u,organizations:d}}),g=O({keyword:"",department:""}),f=O({page:1,limit:10,total:0}),n=O({user_id:"",employee_id:"",position_id:"",org_id:"",department:"",personal_info:"",work_info:"",education_info:"",family_info:""}),H={user_id:[{required:!0,message:"请选择员工",trigger:"change"}],employee_id:[{required:!0,message:"请输入员工编号",trigger:"blur"}],position_id:[{required:!0,message:"请选择岗位",trigger:"change"}],org_id:[{required:!0,message:"请选择组织",trigger:"change"}]},c=async()=>{D.value=!0;try{const s={page:f.page,limit:f.limit,...g},e=await qe(s);b.value=e.data,f.total=e.total}catch{w.error("加载数据失败")}finally{D.value=!1}},J=()=>{g.keyword="",g.department="",f.page=1,c()},Q=async()=>{try{await L.value.validate(),await Oe(n),w.success("保存成功"),V.value=!1,W(),c()}catch(s){s!=="cancel"&&w.error("保存失败")}},W=()=>{Object.assign(n,{user_id:"",employee_id:"",position_id:"",org_id:"",department:"",personal_info:"",work_info:"",education_info:"",family_info:""}),R.value=null},X=s=>{_.value=s,S.value=!0},Y=s=>{R.value=s,Object.assign(n,{user_id:s.user_id,employee_id:s.employee_id,position_id:s.position_id,org_id:s.org_id,department:s.department,personal_info:s.personal_info,work_info:s.work_info,education_info:s.education_info,family_info:s.family_info}),V.value=!0},Z=async s=>{try{await ye.confirm("确定要删除这个档案吗？","提示",{type:"warning"}),await Te(s.id),w.success("删除成功"),c()}catch(e){e!=="cancel"&&w.error(e.message||"删除失败")}},ee=async()=>{try{const[s,e,u]=await Promise.all([Ie(),Ne(),$e()]);N.value=s.data||s,$.value=e.data||e,K.value=u.data||u}catch{w.error("加载基础数据失败")}};return de(()=>{c(),ee()}),(s,e)=>{const u=be,d=Ve,r=ue,M=pe,E=_e,y=ke,le=me,te=fe,j=Pe,P=we,k=Ee,q=Ce,z=Fe,h=ce,ae=Ue,x=ze,oe=xe,se=ve;return v(),C("div",Ke,[o("div",Le,[l(M,{model:g,inline:""},{default:t(()=>[l(d,{label:"关键词"},{default:t(()=>[l(u,{modelValue:g.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>g.keyword=a),placeholder:"搜索姓名、邮箱或员工编号",clearable:"",onKeyup:G(c,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"部门"},{default:t(()=>[l(u,{modelValue:g.department,"onUpdate:modelValue":e[1]||(e[1]=a=>g.department=a),placeholder:"搜索部门",clearable:"",onKeyup:G(c,["enter"])},null,8,["modelValue"])]),_:1}),l(d,null,{default:t(()=>[l(r,{type:"primary",onClick:c},{default:t(()=>[...e[17]||(e[17]=[p("搜索",-1)])]),_:1}),l(r,{onClick:J},{default:t(()=>[...e[18]||(e[18]=[p("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),o("div",Me,[l(r,{type:"primary",onClick:e[2]||(e[2]=a=>V.value=!0)},{default:t(()=>[l(E,null,{default:t(()=>[l(F(Be))]),_:1}),e[19]||(e[19]=p(" 新建档案 ",-1))]),_:1})]),o("div",he,[o("div",Ae,[o("div",Ge,[l(E,null,{default:t(()=>[l(F(De))]),_:1})]),o("div",He,[o("div",Je,i(U.value.total),1),e[20]||(e[20]=o("div",{class:"stat-label"},"总档案数",-1))])]),o("div",Qe,[o("div",We,[l(E,null,{default:t(()=>[l(F(Se))]),_:1})]),o("div",Xe,[o("div",Ye,i(U.value.departments),1),e[21]||(e[21]=o("div",{class:"stat-label"},"部门数量",-1))])]),o("div",Ze,[o("div",el,[l(E,null,{default:t(()=>[l(F(Re))]),_:1})]),o("div",ll,[o("div",tl,i(U.value.positions),1),e[22]||(e[22]=o("div",{class:"stat-label"},"岗位数量",-1))])]),o("div",al,[o("div",ol,[l(E,null,{default:t(()=>[l(F(je))]),_:1})]),o("div",sl,[o("div",nl,i(U.value.organizations),1),e[23]||(e[23]=o("div",{class:"stat-label"},"组织数量",-1))])])]),o("div",il,[re((v(),B(le,{data:b.value,stripe:"",border:""},{default:t(()=>[l(y,{prop:"employee_id",label:"员工编号"},{default:t(({row:a})=>[o("span",dl,i(a.employee_id),1)]),_:1}),l(y,{prop:"user_name",label:"姓名"}),l(y,{prop:"position_name",label:"岗位"}),l(y,{prop:"org_name",label:"所属组织"}),l(y,{prop:"department",label:"部门"},{default:t(({row:a})=>[o("span",rl,i(a.department),1)]),_:1}),l(y,{prop:"created_at",label:"建档时间"}),l(y,{label:"操作",width:"200"},{default:t(({row:a})=>[o("div",ul,[l(r,{size:"small",onClick:A=>X(a)},{default:t(()=>[...e[24]||(e[24]=[p("查看详情",-1)])]),_:1},8,["onClick"]),l(r,{size:"small",type:"primary",onClick:A=>Y(a)},{default:t(()=>[...e[25]||(e[25]=[p("编辑",-1)])]),_:1},8,["onClick"]),l(r,{size:"small",type:"danger",onClick:A=>Z(a)},{default:t(()=>[...e[26]||(e[26]=[p("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[se,D.value]])]),o("div",pl,[l(te,{"current-page":f.page,"onUpdate:currentPage":e[3]||(e[3]=a=>f.page=a),"page-size":f.limit,"onUpdate:pageSize":e[4]||(e[4]=a=>f.limit=a),total:f.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:c,onCurrentChange:c},null,8,["current-page","page-size","total"])]),l(h,{modelValue:V.value,"onUpdate:modelValue":e[15]||(e[15]=a=>V.value=a),title:R.value?"编辑档案":"新建档案",width:"800px"},{footer:t(()=>[l(r,{onClick:e[14]||(e[14]=a=>V.value=!1)},{default:t(()=>[...e[31]||(e[31]=[p("取消",-1)])]),_:1}),l(r,{type:"primary",onClick:Q},{default:t(()=>[...e[32]||(e[32]=[p("保存",-1)])]),_:1})]),default:t(()=>[l(M,{model:n,rules:H,ref_key:"fileFormRef",ref:L,"label-width":"100px"},{default:t(()=>[l(q,{gutter:20},{default:t(()=>[l(k,{span:12},{default:t(()=>[l(d,{label:"员工",prop:"user_id"},{default:t(()=>[l(P,{modelValue:n.user_id,"onUpdate:modelValue":e[5]||(e[5]=a=>n.user_id=a),placeholder:"选择员工",style:{width:"100%"}},{default:t(()=>[(v(!0),C(T,null,I(N.value,a=>(v(),B(j,{key:a.id,label:a.real_name||a.username,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(k,{span:12},{default:t(()=>[l(d,{label:"员工编号",prop:"employee_id"},{default:t(()=>[l(u,{modelValue:n.employee_id,"onUpdate:modelValue":e[6]||(e[6]=a=>n.employee_id=a),placeholder:"请输入员工编号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(q,{gutter:20},{default:t(()=>[l(k,{span:12},{default:t(()=>[l(d,{label:"岗位",prop:"position_id"},{default:t(()=>[l(P,{modelValue:n.position_id,"onUpdate:modelValue":e[7]||(e[7]=a=>n.position_id=a),placeholder:"选择岗位",style:{width:"100%"}},{default:t(()=>[(v(!0),C(T,null,I($.value,a=>(v(),B(j,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(k,{span:12},{default:t(()=>[l(d,{label:"所属组织",prop:"org_id"},{default:t(()=>[l(P,{modelValue:n.org_id,"onUpdate:modelValue":e[8]||(e[8]=a=>n.org_id=a),placeholder:"选择组织",style:{width:"100%"}},{default:t(()=>[(v(!0),C(T,null,I(K.value,a=>(v(),B(j,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(d,{label:"部门"},{default:t(()=>[l(u,{modelValue:n.department,"onUpdate:modelValue":e[9]||(e[9]=a=>n.department=a),placeholder:"请输入部门"},null,8,["modelValue"])]),_:1}),l(z,{"content-position":"left"},{default:t(()=>[...e[27]||(e[27]=[p("个人信息",-1)])]),_:1}),l(d,{label:"个人信息"},{default:t(()=>[l(u,{modelValue:n.personal_info,"onUpdate:modelValue":e[10]||(e[10]=a=>n.personal_info=a),type:"textarea",rows:3,placeholder:"请输入个人信息"},null,8,["modelValue"])]),_:1}),l(z,{"content-position":"left"},{default:t(()=>[...e[28]||(e[28]=[p("工作信息",-1)])]),_:1}),l(d,{label:"工作信息"},{default:t(()=>[l(u,{modelValue:n.work_info,"onUpdate:modelValue":e[11]||(e[11]=a=>n.work_info=a),type:"textarea",rows:3,placeholder:"请输入工作信息"},null,8,["modelValue"])]),_:1}),l(z,{"content-position":"left"},{default:t(()=>[...e[29]||(e[29]=[p("教育信息",-1)])]),_:1}),l(d,{label:"教育信息"},{default:t(()=>[l(u,{modelValue:n.education_info,"onUpdate:modelValue":e[12]||(e[12]=a=>n.education_info=a),type:"textarea",rows:3,placeholder:"请输入教育信息"},null,8,["modelValue"])]),_:1}),l(z,{"content-position":"left"},{default:t(()=>[...e[30]||(e[30]=[p("家庭信息",-1)])]),_:1}),l(d,{label:"家庭信息"},{default:t(()=>[l(u,{modelValue:n.family_info,"onUpdate:modelValue":e[13]||(e[13]=a=>n.family_info=a),type:"textarea",rows:3,placeholder:"请输入家庭信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(h,{modelValue:S.value,"onUpdate:modelValue":e[16]||(e[16]=a=>S.value=a),title:"档案详情",width:"80%"},{default:t(()=>[_.value?(v(),C("div",_l,[l(q,{gutter:20},{default:t(()=>[l(k,{span:8},{default:t(()=>[l(ae,null,{header:t(()=>[...e[33]||(e[33]=[o("span",null,"基本信息",-1)])]),default:t(()=>[o("div",ml,[e[34]||(e[34]=o("span",{class:"label"},"员工编号：",-1)),o("span",fl,i(_.value.employee_id),1)]),o("div",cl,[e[35]||(e[35]=o("span",{class:"label"},"姓名：",-1)),o("span",vl,i(_.value.user_name),1)]),o("div",gl,[e[36]||(e[36]=o("span",{class:"label"},"岗位：",-1)),o("span",yl,i(_.value.position_name),1)]),o("div",bl,[e[37]||(e[37]=o("span",{class:"label"},"所属组织：",-1)),o("span",Vl,i(_.value.org_name),1)]),o("div",kl,[e[38]||(e[38]=o("span",{class:"label"},"部门：",-1)),o("span",wl,i(_.value.department),1)])]),_:1})]),_:1}),l(k,{span:16},{default:t(()=>[l(oe,null,{default:t(()=>[l(x,{label:"个人信息"},{default:t(()=>[o("div",El,[o("pre",null,i(_.value.personal_info||"暂无数据"),1)])]),_:1}),l(x,{label:"工作信息"},{default:t(()=>[o("div",Cl,[o("pre",null,i(_.value.work_info||"暂无数据"),1)])]),_:1}),l(x,{label:"教育信息"},{default:t(()=>[o("div",Fl,[o("pre",null,i(_.value.education_info||"暂无数据"),1)])]),_:1}),l(x,{label:"家庭信息"},{default:t(()=>[o("div",Ul,[o("pre",null,i(_.value.family_info||"暂无数据"),1)])]),_:1})]),_:1})]),_:1})]),_:1})])):ge("",!0)]),_:1},8,["modelValue"])])}}},Al=ne(zl,[["__scopeId","data-v-357188df"]]);export{Al as default};
